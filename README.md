# Sym Programming Language

A minimalist, stack-based scripting language with a bytecode VM, closures, and a C FFI, built from scratch.

---

Sym is a powerful toy language designed to explore the core concepts of language development. It compiles human-readable source code into a custom bytecode format, which is then executed on a high-performance virtual machine.

This repository contains the complete source code for the language, including its parser, bytecode compiler, virtual machine, and a small standard library.

## Features

* **Bytecode Virtual Machine:** Sym is not a slow tree-walking interpreter. It compiles to a compact bytecode representation for efficient execution.
* **Minimalist Syntax:** The language is entirely stack-based, using a small set of symbols and words for all operations.
* **First-Class Functions (Closures):** Functions are treated as data. They can be stored in variables, passed as arguments, and returned from other functions, enabling powerful functional programming patterns.
* **Rich Data Types:** Supports integers, floats, strings, lists, and maps.
* **Proper Scoping:** Includes both a global scope for top-level definitions and a local scope for each function call.
* **Module System:** A simple `import` statement allows for code organization and the creation of standard libraries.
* **Foreign Function Interface (FFI):** Directly call native C functions from within Sym code, opening the door to high-performance system libraries.
* **Developer Experience:** Features precise runtime error reporting with function call stack traces and a built-in interactive debugger.

## The Showcase: `mandelbrot.sym`

The GIF above is a rendering of the Mandelbrot set, generated by a program written entirely in Sym. This example showcases the language's ability to handle complex, non-trivial algorithms involving floating-point math, loops, and conditionals.

You can find the source code for it in [`examples/mandelbrot.sym`](examples/mandelbrot.sym).

## Installation

1. Clone the repository:

   ```bash
   git clone https://github.com/ChPuru/sym.git
   cd sym
   ```

2. Install the Python dependencies:

   ```bash
   pip install -r requirements.txt
   ```

3. Compile the C library for the FFI example:

   ```bash
   make -C ffi_example
   ```

## Usage

All commands should be run from the project's root directory.

### Running a Program

To run a Sym file, use the `-m` flag to invoke the main module:

```bash
python -m src.sym.main examples/mandelbrot.sym
```

### Using the Interactive Debugger

The language has a built-in debugger. To use it, add the `dbg` command to your `.sym` file to create a breakpoint, and run your program with the `--debug` flag:

```bash
python -m src.sym.main --debug examples/final_demo.sym
```

When the debugger stops at a breakpoint, the following commands are available:

* `s` (or `stack`): Show the current data stack.
* `l` (or `locals`): Show the local variables in the current function.
* `g` (or `globals`): Show all global variables.
* `n` (or `next`): Execute the next instruction.
* `c` (or `continue`): Continue execution until the next breakpoint or the end of the program.

## Language Syntax

Sym uses a stack-based syntax where operations work on values pushed to a stack. Here's a quick overview:

### Basic Operations

```sym
# Push values to stack
42 3.14 "hello"

# Arithmetic
5 3 +        # pushes 8
10 2 /       # pushes 5.0
```

### Variables

```sym
# Define a variable
42 x =

# Use a variable
x print
```

### Functions

```sym
# Define a function
[ 2 * ] double =

# Call a function
5 double call print  # outputs 10
```

### Control Flow

```sym
# Conditional
x 0 > [ "positive" print ] [ "non-positive" print ] if

# Loops
10 [ dup print 1 - dup 0 > ] while drop
```

## Examples

The `examples/` directory contains several demonstration programs:

* `mandelbrot.sym` - Mandelbrot set visualization
* `final_demo.sym` - Comprehensive language feature showcase
* `ffi_demo.sym` - C Foreign Function Interface example

## Project Structure

```
sym/
├── src/
│   └── sym/
│       ├── main.py          # Entry point
│       ├── lexer.py         # Tokenization
│       ├── parser.py        # AST generation
│       ├── compiler.py      # Bytecode compilation
│       ├── vm.py           # Virtual machine
│       └── stdlib.py       # Built-in functions
├── examples/               # Example programs
├── ffi_example/           # C FFI demonstration
└── requirements.txt       # Python dependencies
```

## Contributing

Contributions are welcome! Please feel free to submit issues, feature requests, or pull requests.

---

*Built with ❤️ as an exploration of programming language design and implementation.*
